function normalizeParamValue(e,r){return"tid"===e?encodeTidValue(r):String(r)}function resolveDestinationKey(e){if(!e)return"";let r=DESTINATION_KEY_MAP[e];return r?String(r):e}function determinePrimaryKey(e){for(let r=0;r<CLICK_ID_KEYS.length;r+=1){let n=CLICK_ID_KEYS[r],t=e[n];if(null!=t&&""!==t)return n}return null}function prepareParamEntries(e){let r=[];return TRACK_KEYS.forEach(n=>{let t=e[n];null!=t&&""!==t&&r.push({key:n,mappedKey:resolveDestinationKey(n),normalizedValue:normalizeParamValue(n,t)})}),r}function buildReplacementQuery(e,r){let n=[],t=new Set,l=(e,r)=>{if(null==r||""===r)return;let l=resolveDestinationKey(e);if(!l||t.has(l))return;let a=normalizeParamValue(e,r);n.push(`${encodeURIComponent(l)}=${encodeURIComponent(a)}`),t.add(l)};if(e){let a=activeSessionParams[e];l(e,a)}let i=Array.isArray(r)?r:[];return(i.forEach(e=>{if(!e)return;let r,n;Array.isArray(e)?[r,n]=e:"object"==typeof e&&(r=e.key||e.name,n=void 0!==e.value?e.value:activeSessionParams[r]),r&&l(r,n)}),n.length)?n.join("&"):"mxcode=1"}